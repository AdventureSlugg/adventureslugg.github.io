---
import CodeEditor from '../layouts/CodeEditor.astro';
import MainContent from '../layouts/MainContent.astro';
import Layout from '../layouts/Layout.astro';
import TopBar from '../components/top-bar/TopBar.astro';
import Extensions from '../components/extensions/Extensions.astro';
import Explorer from '../components/explorer/Explorer.astro';
import FileTabs from '../components/file-tabs/FileTabs.astro';
import FilePath from '../components/file-path/FilePath.astro';
import type { Tab } from '../components/file-tabs/FileTab.astro';
import type { TreeNodeType } from '../components/explorer/TreeNode.astro';

// import 'bootstrap/dist/js/bootstrap.bundle.min.js'
type Section = {
	id: string; // used to access the section, tab, and node: id-section; id-tab; id-node,
	name: string; // display name,
	subsections?: Section[]; // subsections under this section
}

const sections: Section[] = [
	{
		id: 'landing',
		name: 'Zoes-Playground',
		subsections: [
			{
				id: 'landing',
				name: 'README.md'
			},
			{
				id: 'projects',
				name: 'Projects',
				subsections: [
					{
						id: 'web',
						name: 'Web',
						subsections: [
							{
								id: 'code-racer',
								name: 'Code Racer'
							},
							{
								id: 'apollo-link',
								name: 'Apollo Link'
							},
							{
								id: 'med-o-matic',
								name: 'Med-O-Matic'
							}
						]
					},
					{
						id: 'games',
						name: 'Games',
						subsections: [
							{
								id: 'snail-party',
								name: 'Snail Party'
							},
							{
								id: 'subreddit-royale',
								name: 'Subreddit Royale'
							},
							{
								id: 'vr-hide-and-seek',
								name: 'VR Hide and Seek'
							}
						]
					},
					{
						id: 'libraries',
						name: 'Libraries',
						subsections: [
							{
								id: '3d-sea',
								name: '3D Sea'
							},
							{
								id: 'video-ui',
								name: 'Video UI'
							}
						]
					}
				]
			},
			{
				id: 'process',
				name: 'Process',
				subsections: [
					{
						id: 'visualize',
						name: 'Visualize'
					},
					{
						id: 'analyze',
						name: 'Analyze'
					},
					{
						id: 'deliver',
						name: 'Deliver'
					}
				]
			},
			{
				id: 'philosophy',
				name: 'Philosophy',
				subsections: [
					{
						id: 'craftsmanship',
						name: 'Spinnining the Web'
					},
					{
						id: 'debugging',
						name: "Debugging"
					},
					{
						id: 'extendibility',
						name: "Expanding the Web"
					}
				]
			},
			{
				id: 'contact',
				name: 'Contact'
			}
		]
	}
]

const tabs: Tab[] = sections[0].subsections!.map( (section) => {
	return {
		name: section.name,
		id: section.id
	}
});

const sectionToExplorer = (section: Section): TreeNodeType => {
	return {
		name: section.name,
		id: section.id,
		children: section.subsections ? section.subsections.map( (subsection) => sectionToExplorer(subsection) ) : undefined
	}
};

const explorer = sectionToExplorer(sections[0])

---

<Layout>
	<CodeEditor>
		<div slot="top-bar">
			<TopBar/>
		</div>

		<div slot="extensions">
			<Extensions/>
		</div>

		<div slot="file-explorer">
			<Explorer rootNode={explorer}/>
		</div>

		<div slot="tab-section">
			<FileTabs tabs={tabs}/>
		</div>

		<div slot="file-path">
			<FilePath/>
		</div>

		<div class="full-relative-height" slot="main-content">
			<MainContent></MainContent>
		</div>

	</CodeEditor>
</Layout>

<script src="../scripts/locationObserver.ts"></script>
<script src="../scripts/clickObservers.ts"></script>